#!/usr/bin/env ruby

require_relative '../lib/router'
require_relative '../lib/poller'
require_relative '../lib/load_config'
require_relative '../lib/router_client'

TEST_MODE_ON = true
TEST_MODE_OFF = false
ARGV[2].nil? ? TEST_MODE = TEST_MODE_OFF : TEST_MODE = TEST_MODE_ON
puts ARGV[2]
puts TEST_MODE
computer = RouterClient.new(TEST_MODE)
router = Router.new(computer, TEST_MODE)
router.sandbox_id = ARGV[0]
router.turn_test_mode_on("#{ARGV[1]}")

config = LoadConfig.new
polling_interval = config.polling_interval_seconds
server_url = config.server_url
poller = Poller.new(router, server_url)
poller.time_in_sec=polling_interval
poller.poll_for_ipn

